<!doctype html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MisayaEmby用户中心</title>
  <link rel="stylesheet" href="/app/styles.css">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <!-- 顶部应用栏移除，按需还原可恢复此块 -->

  <main id="pages">
    <!-- 首页：个人信息 -->
    <section class="page active" id="page-home">
      <div class="hero-card">
        <h2>MisayaEmby用户中心</h2>
        <p>账户信息与服务管理</p>
      </div>

      <!-- 线路选择弹层（点击“绑定线路”时显示） -->
      <div id="route-modal" class="modal" aria-hidden="true">
        <div class="modal-backdrop" data-close="route-modal"></div>
        <div class="modal-panel">
          <div class="modal-title">选择线路</div>
          <div id="route-list" class="route-list"></div>
          <div class="modal-actions">
            <button class="btn ghost" id="route-cancel" data-close="route-modal">取消</button>
          </div>
        </div>
      </div>

      <!-- 注册/绑定 弹层 -->
      <div id="register-modal" class="modal" aria-hidden="true">
        <div class="modal-backdrop" data-close="register-modal"></div>
        <div class="modal-panel">
          <div class="modal-title">注册 / 绑定</div>
          <div class="form">
            <div class="form-row">
              <label for="reg-username">用户名</label>
              <input id="reg-username" type="text" placeholder="请输入要注册的用户名" autocomplete="username" />
            </div>
            <div class="form-row">
              <label for="reg-password">密码</label>
              <input id="reg-password" type="password" placeholder="请输入密码" autocomplete="new-password" />
            </div>
            <div class="form-error" id="reg-error" style="display:none"></div>
          </div>
          <div class="modal-actions">
            <button class="btn ghost" id="reg-cancel" data-close="register-modal">取消</button>
            <button class="btn primary" id="reg-submit">提交</button>
          </div>
        </div>
      </div>

      <div class="card profile">
        <div class="card-title with-icon">
          <span class="icon">👤</span>
          <span>个人信息</span>
        </div>
        <div class="kv">
          <div><span class="k">绑定状态：</span><span class="v" id="kv-bound">-</span></div>
          <div><span class="k">到期时间：</span><span class="v" id="kv-exp">-</span></div>
          <div><span class="k">可用积分：</span><span class="v" id="kv-points">0</span></div>
          <div><span class="k">捐赠金额：</span><span class="v" id="kv-donation">0</span></div>
        </div>
        <div class="card-actions row">
          <button class="btn" id="btn-register">注册 / 绑定</button>
          <button class="btn" id="btn-bind-existing">绑定已有账号</button>
          <button class="btn" id="btn-points">刷新状态</button>
        </div>
      </div>

      <div class="card emby">
        <div class="card-title with-icon">
          <img class="icon-svg" src="/app/emby.svg" alt="Emby" />
          <span>Emby 账户</span>
        </div>
        <div class="kv">
          <div>
            <span class="row-icon">👤</span>
            <span class="k">用户名：</span>
            <span class="v" id="emby-username">-</span>
          </div>
          <div>
            <span class="row-icon">📅</span>
            <span class="k">注册日期：</span>
            <span class="v" id="emby-created">-</span>
          </div>
          <div>
            <span class="row-icon">⏱️</span>
            <span class="k">观看等级：</span>
            <span class="v" id="emby-level">☆</span>
          </div>
          <div>
            <span class="row-icon">📁</span>
            <span class="k">资料库权限：</span>
            <span class="v badge badge-green" id="emby-perm">全部</span>
          </div>
          <div>
            <span class="row-icon">🌐</span>
            <span class="k">入口线路：</span>
            <span class="v badge badge-red" id="emby-entry">-</span>
          </div>
          <div>
            <span class="row-icon">🛠️</span>
            <span class="k">绑定线路：</span>
            <span class="v badge" id="emby-bound">未设置</span>
          </div>
        </div>
        
      </div>

      <div class="card discuss">
        <div class="card-title with-icon">
          <img class="icon-svg" src="/app/discuss_chat_group.svg" alt="Discuss" />
          <span>交流讨论</span>
        </div>
        <div class="list discuss-list">
          <div class="list-item discuss-item" data-url="https://t.me/misayaemby">
            <div class="li-left">
              <div class="li-icon green" aria-hidden="true">
                <img src="/app/chat.svg" alt="chat" width="20" height="20" />
              </div>
              <div class="li-text">
                <div class="li-title">用户交流群</div>
                <div class="li-sub">随便聊聊</div>
              </div>
            </div>
            <div class="li-actions icon-actions">
              <button class="icon-btn copy" aria-label="复制链接" title="复制链接" data-copy="https://t.me/misayaemby">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 9.5A2.5 2.5 0 0 1 11.5 7H18a2 2 0 0 1 2 2v6.5A2.5 2.5 0 0 1 17.5 18H11a2 2 0 0 1-2-2V9.5Z" stroke="#334155" stroke-width="1.5"/><path d="M7 16.5A2.5 2.5 0 0 1 4.5 14V7.5A2.5 2.5 0 0 1 7 5h6.5A2.5 2.5 0 0 1 16 7.5" stroke="#334155" stroke-width="1.5"/></svg>
              </button>
              <a class="icon-btn enter" aria-label="打开链接" title="打开链接" href="https://t.me/misayaemby" target="_blank">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5l8 7-8 7" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </a>
            </div>
          </div>
          <div class="list-item discuss-item" data-url="https://t.me/misayady">
            <div class="li-left">
              <div class="li-icon orange" aria-hidden="true">
                <img src="/app/megaphone.svg" alt="megaphone" width="20" height="20" />
              </div>
              <div class="li-text">
                <div class="li-title">官方通知频道</div>
                <div class="li-sub">获取最新服务公告和更新</div>
              </div>
            </div>
            <div class="li-actions icon-actions">
              <button class="icon-btn copy" aria-label="复制链接" title="复制链接" data-copy="https://t.me/misayady">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9 9.5A2.5 2.5 0 0 1 11.5 7H18a2 2 0 0 1 2 2v6.5A2.5 2.5 0 0 1 17.5 18H11a2 2 0 0 1-2-2V9.5Z" stroke="#334155" stroke-width="1.5"/><path d="M7 16.5A2.5 2.5 0 0 1 4.5 14V7.5A2.5 2.5 0 0 1 7 5h6.5A2.5 2.5 0 0 1 16 7.5" stroke="#334155" stroke-width="1.5"/></svg>
              </button>
              <a class="icon-btn enter" aria-label="打开链接" title="打开链接" href="https://t.me/misayady" target="_blank">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8 5l8 7-8 7" stroke="#1d4ed8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 幸运大转盘弹层 -->
    <div id="wheel-modal" class="modal" aria-hidden="true">
      <div class="modal-backdrop" data-close="wheel-modal"></div>
      <div class="modal-panel wheel-panel">
        <div class="modal-title wheel-titlebar">
          <span class="wheel-title-icon" aria-hidden="true">🎡</span>
          <span>幸运大转盘</span>
          <button class="btn ghost" id="wheel-close" data-close="wheel-modal" style="margin-left:auto">×</button>
        </div>
        <div class="wheel-stage">
          <canvas id="wheel-canvas" width="360" height="360"></canvas>
          <div class="wheel-pointer" id="wheel-pointer"></div>
          <button class="btn wheel-start" id="wheel-start">开始</button>
        </div>
        <div class="wheel-hint" id="wheel-hint"></div>
      </div>
    </div>

    <!-- 活动页（占位） -->
    <section class="page" id="page-activity">
      <div class="hero-card">
        <h2>活动专区</h2>
        <p>转盘、竞拍等互动活动</p>
      </div>
      <div class="card wheel-card">
        <div class="wheel-head">
          <div class="wheel-logo" aria-hidden="true">
            <svg viewBox="0 0 24 24" width="28" height="28" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" r="10" fill="#f59e0b"/><path d="M12 4v16M4 12h16M5.6 6.4l12.8 11.2M18.4 6.4L5.6 17.6" stroke="#fff" stroke-width="1.6"/></svg>
          </div>
          <div class="wheel-title">
            <div class="t">幸运大转盘</div>
            <div class="s">转一转，赢取丰厚奖励</div>
          </div>
        </div>
        <div class="wheel-badges">
          <span class="badge wheel green">最低积分要求：<b id="wheel-min">-</b></span>
          <span class="badge wheel blue">参与消耗积分：<b id="wheel-cost">-</b></span>
        </div>
        <div class="wheel-actions">
          <button class="btn primary" id="wheel-open">立即参与</button>
          <a class="wheel-link" id="wheel-open-link">点击进入活动</a>
        </div>
      </div>
      <div class="card">
        <div class="card-title with-icon"><span class="icon">🔨</span><span>竞拍活动</span></div>
        <p>最低积分要求：10 ｜ 可免费参与</p>
        <button class="btn primary" disabled>敬请期待</button>
      </div>
    </section>

    <!-- 管理页（占位，引导到 /app/admin.html） -->
    <section class="page" id="page-admin">
      <div class="hero-card">
        <h2>管理中心</h2>
        <p>系统管理与配置</p>
      </div>
      <div class="card">
        <div class="card-title with-icon"><span class="icon">⚙️</span><span>系统设置项</span></div>
        <p>打开管理员页面以调整默认初始天数等配置。</p>
        <a class="btn" href="/app/admin.html" target="_blank">打开管理员页面</a>
      </div>
    </section>

    <!-- 排行榜（占位） -->
    <section class="page" id="page-rank">
      <div class="hero-card"><h2>排行榜</h2><p>积分、捐赠与观看时长排名</p></div>
      <div class="card"><div class="card-title">积分榜</div><p>敬请期待</p></div>
    </section>
  </main>

  <!-- 底部导航 -->
  <nav class="tabbar">
    <button class="tab active" data-tab="home">
      <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 4.75a3.25 3.25 0 1 1 0 6.5 3.25 3.25 0 0 1 0-6.5Zm0 7.75c4.14 0 7.5 2.64 7.5 5.9 0 .33-.27.6-.6.6H5.1a.6.6 0 0 1-.6-.6c0-3.26 3.36-5.9 7.5-5.9Z"/>
      </svg>
      <span>个人信息</span>
    </button>
    <button class="tab" data-tab="activity">
      <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M7.5 3.5a1 1 0 0 1 1 1V6h7V4.5a1 1 0 1 1 2 0V6h.25A2.75 2.75 0 0 1 20.5 8.75v8.5A2.75 2.75 0 0 1 17.75 20H6.25A2.75 2.75 0 0 1 3.5 17.25v-8.5A2.75 2.75 0 0 1 6.25 6H6.5V4.5a1 1 0 0 1 1-1Z"/>
        <rect x="7" y="10.2" width="6.2" height="1.6" rx="0.8" fill="currentColor"/>
        <rect x="7" y="13.6" width="6.2" height="1.6" rx="0.8" fill="currentColor"/>
        <circle cx="17" cy="15.5" r="2.2" fill="currentColor"/>
        <path d="M17 14.2v1.2l.95.6" stroke="#fff" stroke-width="1.4" stroke-linecap="round"/>
      </svg>
      <span>活动</span>
    </button>
    <button class="fab" id="fab">＋</button>
    <button class="tab" data-tab="admin">
      <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M12 3a1 1 0 0 1 1 .85l.14.86a7.3 7.3 0 0 1 1.84.76l.78-.45a1 1 0 0 1 1.36.37l1.5 2.6a1 1 0 0 1-.37 1.36l-.78.45c.1.31.18.64.24.97.06.33.09.66.09 1s-.03.67-.09 1a7.5 7.5 0 0 1-.24.97l.78.45a1 1 0 0 1 .37 1.36l-1.5 2.6a1 1 0 0 1-1.36.37l-.78-.45a7.3 7.3 0 0 1-1.84.76l-.14.86a1 1 0 0 1-1 .85h-3a1 1 0 0 1-1-.85l-.14-.86a7.3 7.3 0 0 1-1.84-.76l-.78.45a1 1 0 0 1-1.36-.37l-1.5-2.6a1 1 0 0 1 .37-1.36l.78-.45a7.5 7.5 0 0 1-.24-.97 7 7 0 0 1 0-2c.06-.33.14-.66.24-.97l-.78-.45a1 1 0 0 1-.37-1.36l1.5-2.6a1 1 0 0 1 1.36-.37l.78.45c.58-.34 1.2-.61 1.84-.76l.14-.86A1 1 0 0 1 9 3h3Zm0 6a3 3 0 1 0 0 6 3 3 0 0 0 0-6Z"/>
      </svg>
      <span>管理</span>
    </button>
    <button class="tab" data-tab="rank">
      <svg viewBox="0 0 24 24" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 5h10v2.5A3.5 3.5 0 0 1 13.5 11h-3A3.5 3.5 0 0 1 7 7.5V5Z"/>
        <path d="M7 6.5H5.6A2.1 2.1 0 0 0 3.5 8.6v.4A2.5 2.5 0 0 0 6 11H7V6.5Z"/>
        <path d="M17 6.5h1.4A2.1 2.1 0 0 1 20.5 8.6v.4A2.5 2.5 0 0 1 18 11h-1V6.5Z"/>
        <rect x="10.2" y="11.2" width="3.6" height="3.6" rx="0.8" fill="currentColor"/>
        <rect x="8" y="17.6" width="8" height="2" rx="1" fill="currentColor"/>
      </svg>
      <span>排行榜</span>
    </button>
  </nav>

  <!-- FAB 扩展菜单 -->
  <div class="fab-menu" id="fab-menu">
    <button class="fab-item" id="fab-redeem">兑换邀请码</button>
    <button class="fab-item" id="fab-bind">绑定媒体账号</button>
    <button class="fab-item" id="fab-bind-line">绑定线路</button>
    <button class="fab-close" id="fab-close">×</button>
  </div>

  

  <pre id="log" class="log"></pre>

  <script src="/app/app.js?v=20250915-02"></script>
</body>
</html>
